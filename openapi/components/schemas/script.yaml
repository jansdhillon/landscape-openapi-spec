# SPDX-License-Identifier: Apache-2.0

ScriptCreatedBy:
  type: object
  x-oapi-codegen-extra-tags:
    tfsdk: "created_by"
  properties:
    id:
      type: integer
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "id"
      description: The ID of the person who created the script.
    name:
      type: string
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "name"
      description: The name of the person who created the script.
  required:
    - id
    - name

ScriptLastEditedBy:
  type: object
  x-oapi-codegen-extra-tags:
    tfsdk: "last_edited_by"
  properties:
    id:
      type: integer
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "id"
      description: The ID of the person who edited the script.
    name:
      type: string
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "name"
      description: The name of the person who edited the script.
  required:
    - id
    - name

LegacyScriptCreator:
  type: object
  x-oapi-codegen-extra-tags:
    tfsdk: "creator"
  properties:
    id:
      type: integer
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "id"
    name:
      type: string
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "name"
    email:
      type: string
      format: email
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "email"
  required:
    - id
    - name
    - email

ScriptAttachment:
  type: object
  properties:
    id:
      type: integer
      x-oapi-codegen-extra-tags:
        tfsdk: "id"
    filename:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "filename"
  required:
    - id
    - filename

LegacyScriptAttachment:
  type: string

ScriptProfile:
  type: object
  properties:
    id:
      type: integer
      x-oapi-codegen-extra-tags:
        tfsdk: "id"
    title:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "title"
  required:
    - id
    - title

V1Script:
  type: object
  properties:
    id:
      type: integer
      x-oapi-codegen-extra-tags:
        tfsdk: "id"
    title:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "title"
    creator:
      $ref: "#/LegacyScriptCreator"
      nullable: true
    status:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "status"
      enum:
        - V1
    attachments:
      type: array
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "attachments"
      items:
        $ref: "#/LegacyScriptAttachment"
    access_group:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "access_group"
    time_limit:
      type: integer
      x-oapi-codegen-extra-tags:
        tfsdk: "time_limit"
    username:
      type: string
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "username"
  required:
    - id
    - title
    - status

V2Script:
  type: object
  properties:
    id:
      type: integer
      x-oapi-codegen-extra-tags:
        tfsdk: "id"
    title:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "title"
    version_number:
      type: integer
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "version_number"
    created_at:
      type: string
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "created_at"
    created_by:
      $ref: "#/ScriptCreatedBy"
      nullable: true
    last_edited_at:
      type: string
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "last_edited_at"
    last_edited_by:
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "last_edited_by"
      $ref: "#/ScriptLastEditedBy"
    script_profiles:
      type: array
      nullable: true
      items:
        $ref: "#/ScriptProfile"
      x-oapi-codegen-extra-tags:
        tfsdk: "script_profiles"
    status:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "status"
      enum:
        - ARCHIVED
        - REDACTED
        - ACTIVE
    attachments:
      type: array
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "attachments"
      items:
        $ref: "#/ScriptAttachment"
    code:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "code"
    interpreter:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "interpreter"
    access_group:
      type: string
      x-oapi-codegen-extra-tags:
        tfsdk: "access_group"
    time_limit:
      type: integer
      x-oapi-codegen-extra-tags:
        tfsdk: "time_limit"
    username:
      type: string
      nullable: true
      x-oapi-codegen-extra-tags:
        tfsdk: "username"
    is_redactable:
      type: boolean
      x-oapi-codegen-extra-tags:
        tfsdk: "is_redactable"
    is_editable:
      type: boolean
      x-oapi-codegen-extra-tags:
        tfsdk: "is_editable"
    is_executable:
      type: boolean
      x-oapi-codegenw-extra-tags:
        tfsdk: "is_executable"
  required:
    - id
    - title
    - status

ScriptResult:
  oneOf:
    - $ref: '#/V1Script'
    - $ref: '#/V2Script'
  discriminator:
    propertyName: status
    mapping:
      V1: '#/V1Script'
      ARCHIVED: '#/V2Script'
      REDACTED: '#/V2Script'
      ACTIVE: '#/V2Script'
